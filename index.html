<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Julinemart HR System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ⚠️ REPLACE THESE WITH YOUR ACTUAL SUPABASE CREDENTIALS
        const SUPABASE_URL = 'https://uttpqcovbuxaheguqvyo.supabase.co';  // Example: https://xxxxx.supabase.co
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV0dHBxY292YnV4YWhlZ3VxdnlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyNjIwMTUsImV4cCI6MjA3NDgzODAxNX0.DSoOumPSSZKfs4e308-vTP6BItl-Bx8SWUHqz6ALKa0';  // Long string starting with eyJ...

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // Icons (simple SVG)
        const Icons = {
            Users: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
            Dollar: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            Calendar: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>,
            Clock: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            Chart: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>,
            Plus: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" /></svg>,
            Edit: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>,
            Trash: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>,
            Download: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>,
            Lock: () => <svg className="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>,
            Logout: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" /></svg>
        };

        function App() {
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [loginForm, setLoginForm] = useState({ username: '', password: '' });
            const [loginError, setLoginError] = useState('');
            const [activeTab, setActiveTab] = useState('dashboard');
            const [employees, setEmployees] = useState([]);
            const [payrolls, setPayrolls] = useState([]);
            const [leaveRequests, setLeaveRequests] = useState([]);
            const [attendance, setAttendance] = useState([]);
            const [loading, setLoading] = useState(false);
            const [showModal, setShowModal] = useState(false);
            const [modalType, setModalType] = useState('');
            const [editingItem, setEditingItem] = useState(null);

            const [employeeForm, setEmployeeForm] = useState({
                name: '', email: '', position: '', department: '', salary: '', joinDate: '', leaveBalance: 20
            });
            const [payrollForm, setPayrollForm] = useState({
                employeeId: '', month: '', year: '', basicSalary: '', allowances: 0, deductions: 0, taxRate: 10
            });
            const [leaveForm, setLeaveForm] = useState({
                employeeId: '', startDate: '', endDate: '', reason: '', type: 'Annual'
            });
            const [attendanceForm, setAttendanceForm] = useState({
                employeeId: '', date: '', status: 'Present'
            });

            useEffect(() => {
                const loggedIn = localStorage.getItem('julinemart_logged_in');
                if (loggedIn === 'true') {
                    setIsLoggedIn(true);
                }
            }, []);

            useEffect(() => {
                if (isLoggedIn) {
                    loadAllData();
                }
            }, [isLoggedIn]);

            const handleLogin = async () => {
                setLoginError('');
                setLoading(true);

                try {
                    const { data, error } = await supabase
                        .from('admin_users')
                        .select('*')
                        .eq('username', loginForm.username)
                        .eq('password', loginForm.password)
                        .single();

                    if (error || !data) {
                        setLoginError('Invalid username or password');
                    } else {
                        setIsLoggedIn(true);
                        localStorage.setItem('julinemart_logged_in', 'true');
                        setLoginForm({ username: '', password: '' });
                    }
                } catch (err) {
                    setLoginError('Login failed. Please check your credentials.');
                }

                setLoading(false);
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                localStorage.removeItem('julinemart_logged_in');
                setActiveTab('dashboard');
            };

            const loadAllData = async () => {
                setLoading(true);
                try {
                    const [empData, payData, leaveData, attData] = await Promise.all([
                        supabase.from('employees').select('*').order('id', { ascending: true }),
                        supabase.from('payrolls').select('*').order('id', { ascending: false }),
                        supabase.from('leave_requests').select('*').order('id', { ascending: false }),
                        supabase.from('attendance').select('*').order('date', { ascending: false })
                    ]);

                    if (empData.data) setEmployees(empData.data);
                    if (payData.data) setPayrolls(payData.data);
                    if (leaveData.data) setLeaveRequests(leaveData.data);
                    if (attData.data) setAttendance(attData.data);
                } catch (error) {
                    console.error('Error loading data:', error);
                }
                setLoading(false);
            };

            const openModal = (type, item = null) => {
                setModalType(type);
                setEditingItem(item);
                if (item && type === 'employee') {
                    setEmployeeForm({
                        name: item.name,
                        email: item.email,
                        position: item.position,
                        department: item.department,
                        salary: item.salary,
                        joinDate: item.join_date,
                        leaveBalance: item.leave_balance
                    });
                }
                setShowModal(true);
            };

            const closeModal = () => {
                setShowModal(false);
                setEditingItem(null);
                setEmployeeForm({ name: '', email: '', position: '', department: '', salary: '', joinDate: '', leaveBalance: 20 });
                setPayrollForm({ employeeId: '', month: '', year: '', basicSalary: '', allowances: 0, deductions: 0, taxRate: 10 });
                setLeaveForm({ employeeId: '', startDate: '', endDate: '', reason: '', type: 'Annual' });
                setAttendanceForm({ employeeId: '', date: '', status: 'Present' });
            };

            const handleAddEmployee = async () => {
                setLoading(true);
                try {
                    if (editingItem) {
                        await supabase
                            .from('employees')
                            .update({
                                name: employeeForm.name,
                                email: employeeForm.email,
                                position: employeeForm.position,
                                department: employeeForm.department,
                                salary: parseFloat(employeeForm.salary),
                                join_date: employeeForm.joinDate,
                                leave_balance: parseInt(employeeForm.leaveBalance)
                            })
                            .eq('id', editingItem.id);
                    } else {
                        await supabase.from('employees').insert([{
                            name: employeeForm.name,
                            email: employeeForm.email,
                            position: employeeForm.position,
                            department: employeeForm.department,
                            salary: parseFloat(employeeForm.salary),
                            join_date: employeeForm.joinDate,
                            leave_balance: parseInt(employeeForm.leaveBalance)
                        }]);
                    }
                    await loadAllData();
                    closeModal();
                } catch (error) {
                    alert('Error saving employee: ' + error.message);
                }
                setLoading(false);
            };

            const handleDeleteEmployee = async (id) => {
                if (confirm('Are you sure you want to delete this employee?')) {
                    setLoading(true);
                    try {
                        await supabase.from('employees').delete().eq('id', id);
                        await loadAllData();
                    } catch (error) {
                        alert('Error deleting employee: ' + error.message);
                    }
                    setLoading(false);
                }
            };

            const handleAddPayroll = async () => {
                const employee = employees.find(e => e.id === parseInt(payrollForm.employeeId));
                if (!employee) return;

                const basicSalary = parseFloat(payrollForm.basicSalary) || employee.salary;
                const allowances = parseFloat(payrollForm.allowances) || 0;
                const deductions = parseFloat(payrollForm.deductions) || 0;
                const taxRate = parseFloat(payrollForm.taxRate) || 10;
                
                const grossSalary = basicSalary + allowances;
                const tax = (grossSalary * taxRate) / 100;
                const netSalary = grossSalary - tax - deductions;

                setLoading(true);
                try {
                    await supabase.from('payrolls').insert([{
                        employee_id: employee.id,
                        employee_name: employee.name,
                        month: payrollForm.month,
                        year: payrollForm.year,
                        basic_salary: basicSalary,
                        allowances,
                        deductions,
                        tax,
                        gross_salary: grossSalary,
                        net_salary: netSalary
                    }]);
                    await loadAllData();
                    closeModal();
                } catch (error) {
                    alert('Error generating payroll: ' + error.message);
                }
                setLoading(false);
            };

            const handleAddLeave = async () => {
                const employee = employees.find(e => e.id === parseInt(leaveForm.employeeId));
                if (!employee) return;

                const startDate = new Date(leaveForm.startDate);
                const endDate = new Date(leaveForm.endDate);
                const days = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;

                setLoading(true);
                try {
                    await supabase.from('leave_requests').insert([{
                        employee_id: employee.id,
                        employee_name: employee.name,
                        start_date: leaveForm.startDate,
                        end_date: leaveForm.endDate,
                        days,
                        reason: leaveForm.reason,
                        type: leaveForm.type,
                        status: 'Pending'
                    }]);
                    await loadAllData();
                    closeModal();
                } catch (error) {
                    alert('Error submitting leave: ' + error.message);
                }
                setLoading(false);
            };

            const handleLeaveAction = async (id, action) => {
                const leave = leaveRequests.find(l => l.id === id);
                if (!leave) return;

                const newStatus = action === 'approve' ? 'Approved' : 'Rejected';
                setLoading(true);
                try {
                    await supabase.from('leave_requests').update({ status: newStatus }).eq('id', id);
                    if (action === 'approve') {
                        const employee = employees.find(e => e.id === leave.employee_id);
                        if (employee) {
                            await supabase.from('employees')
                                .update({ leave_balance: employee.leave_balance - leave.days })
                                .eq('id', leave.employee_id);
                        }
                    }
                    await loadAllData();
                } catch (error) {
                    alert('Error updating leave: ' + error.message);
                }
                setLoading(false);
            };

            const handleAddAttendance = async () => {
                const employee = employees.find(e => e.id === parseInt(attendanceForm.employeeId));
                if (!employee) return;

                setLoading(true);
                try {
                    await supabase.from('attendance').insert([{
                        employee_id: employee.id,
                        employee_name: employee.name,
                        date: attendanceForm.date,
                        status: attendanceForm.status
                    }]);
                    await loadAllData();
                    closeModal();
                } catch (error) {
                    alert('Error marking attendance: ' + error.message);
                }
                setLoading(false);
            };

            const downloadPayslip = (payroll) => {
                const content = `JULINEMART - Official Payslip

Employee: ${payroll.employee_name}
Period: ${payroll.month} ${payroll.year}
Date: ${payroll.generated_date}

EARNINGS
Basic Salary:     $${parseFloat(payroll.basic_salary).toFixed(2)}
Allowances:       $${parseFloat(payroll.allowances).toFixed(2)}
Gross Salary:     $${parseFloat(payroll.gross_salary).toFixed(2)}

DEDUCTIONS
Tax:              $${parseFloat(payroll.tax).toFixed(2)}
Other:            $${parseFloat(payroll.deductions).toFixed(2)}

NET SALARY:       $${parseFloat(payroll.net_salary).toFixed(2)}`;

                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `Payslip_${payroll.employee_name}_${payroll.month}_${payroll.year}.txt`;
                a.click();
            };

            const totalSalary = payrolls.reduce((sum, p) => sum + parseFloat(p.net_salary || 0), 0);
            const pendingLeaves = leaveRequests.filter(l => l.status === 'Pending').length;
            const todayDate = new Date().toISOString().split('T')[0];
            const todayAttendance = attendance.filter(a => a.date === todayDate);
            const presentToday = todayAttendance.filter(a => a.status === 'Present').length;

            if (!isLoggedIn) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center p-4">
                        <div className="bg-white rounded-lg shadow-2xl p-8 max-w-md w-full">
                            <div className="text-center mb-8">
                                <div className="inline-block p-3 bg-blue-100 rounded-full mb-4">
                                    <Icons.Lock />
                                </div>
                                <h1 className="text-3xl font-bold text-gray-800">Julinemart HR</h1>
                                <p className="text-gray-600 mt-2">Login to access your system</p>
                            </div>

                            {loginError && (
                                <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                                    {loginError}
                                </div>
                            )}

                            <div className="space-y-4">
                                <input
                                    type="text"
                                    placeholder="Username"
                                    value={loginForm.username}
                                    onChange={(e) => setLoginForm({ ...loginForm, username: e.target.value })}
                                    onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                    className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                />
                                <input
                                    type="password"
                                    placeholder="Password"
                                    value={loginForm.password}
                                    onChange={(e) => setLoginForm({ ...loginForm, password: e.target.value })}
                                    onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                    className="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                />
                                <button
                                    onClick={handleLogin}
                                    disabled={loading}
                                    className="w-full bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 font-semibold disabled:bg-blue-300"
                                >
                                    {loading ? 'Logging in...' : 'Login'}
                                </button>
                            </div>

                            <div className="mt-6 text-center text-sm text-gray-600">
                                <p className="mb-2">Default Login:</p>
                                <div className="bg-gray-100 p-3 rounded">
                                    <p className="font-mono">Username: <strong>admin</strong></p>
                                    <p className="font-mono">Password: <strong>admin123</strong></p>
                                </div>
                                <p className="text-xs text-red-600 mt-2">Change password after first login</p>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    <div className="bg-blue-600 text-white p-6 shadow-lg">
                        <div className="container mx-auto flex justify-between items-center">
                            <div>
                                <h1 className="text-3xl font-bold">Julinemart HR System</h1>
                                <p className="text-blue-100">Complete HR Management</p>
                            </div>
                            <button
                                onClick={handleLogout}
                                className="flex items-center space-x-2 bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-lg"
                            >
                                <Icons.Logout />
                                <span>Logout</span>
                            </button>
                        </div>
                    </div>

                    <div className="bg-white shadow-md border-b">
                        <div className="container mx-auto px-6">
                            <div className="flex space-x-1 overflow-x-auto">
                                {[
                                    { id: 'dashboard', icon: Icons.Chart, label: 'Dashboard' },
                                    { id: 'employees', icon: Icons.Users, label: 'Employees' },
                                    { id: 'payroll', icon: Icons.Dollar, label: 'Payroll' },
                                    { id: 'leave', icon: Icons.Calendar, label: 'Leave' },
                                    { id: 'attendance', icon: Icons.Clock, label: 'Attendance' }
                                ].map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`flex items-center space-x-2 px-6 py-4 border-b-2 transition ${
                                            activeTab === tab.id
                                                ? 'border-blue-600 text-blue-600'
                                                : 'border-transparent text-gray-600 hover:text-blue-600'
                                        }`}
                                    >
                                        {React.createElement(tab.icon)}
                                        <span className="font-medium">{tab.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {loading && (
                        <div className="bg-blue-600 text-white text-center py-2">Loading...</div>
                    )}

                    <div className="container mx-auto px-6 py-8">
                        {activeTab === 'dashboard' && (
                            <div>
                                <h2 className="text-2xl font-bold mb-6">Dashboard</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                                    <div className="bg-white p-6 rounded-lg shadow-md">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-gray-500 text-sm">Total Employees</p>
                                                <p className="text-3xl font-bold text-blue-600">{employees.length}</p>
                                            </div>
                                            <Icons.Users />
                                        </div>
                                    </div>
                                    <div className="bg-white p-6 rounded-lg shadow-md">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-gray-500 text-sm">Total Payroll</p>
                                                <p className="text-3xl font-bold text-green-600">${totalSalary.toFixed(0)}</p>
                                            </div>
                                            <Icons.Dollar />
                                        </div>
                                    </div>
                                    <div className="bg-white p-6 rounded-lg shadow-md">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-gray-500 text-sm">Pending Leaves</p>
                                                <p className="text-3xl font-bold text-orange-600">{pendingLeaves}</p>
                                            </div>
                                            <Icons.Calendar />
                                        </div>
                                    </div>
                                    <div className="bg-white p-6 rounded-lg shadow-md">
                                        <div className="flex items-center justify-between">
                                            <div>
                                                <p className="text-gray-500 text-sm">Present Today</p>
                                                <p className="text-3xl font-bold text-purple-600">{presentToday}</p>
                                            </div>
                                            <Icons.Clock />
                                        </div>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <div className="bg-white p-6 rounded-lg shadow-md">
                                        <h3 className="text-xl font-bold mb-4">Recent Employees</h3>
                                        {employees.slice(0, 5).map(emp => (
                                            <div key={emp.id} className="border-b py-3 last:border-0">
                                                <p className="font-semibold">{emp.name}</p>
                                                <p className="text-sm text-gray-600">{emp.position}</p>
                                            </div>
                                        ))}
                                        {employees.length === 0 && <p className="text-gray-500 text-center py-4">No employees yet</p>}
                                    </div>

                                    <div className="bg-white p-6 rounded-lg shadow-md">
                                        <h3 className="text-xl font-bold mb-4">Recent Payrolls</h3>
                                        {payrolls.slice(0, 5).map(pay => (
                                            <div key={pay.id} className="border-b py-3 last:border-0 flex justify-between">
                                                <div>
                                                    <p className="font-semibold">{pay.employee_name}</p>
                                                    <p className="text-sm text-gray-600">{pay.month} {pay.year}</p>
                                                </div>
                                                <p className="text-lg font-bold text-green-600">${parseFloat(pay.net_salary).toFixed(2)}</p>
                                            </div>
                                        ))}
                                        {payrolls.length === 0 && <p className="text-gray-500 text-center py-4">No payrolls yet</p>}
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'employees' && (
                            <div>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold">Employees</h2>
                                    <button
                                        onClick={() => openModal('employee')}
                                        className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700"
                                    >
                                        <Icons.Plus />
                                        <span>Add Employee</span>
                                    </button>
                                </div>
                                <div className="bg-white rounded-lg shadow-md overflow-x-auto">
                                    <table className="w-full">
                                        <thead className="bg-gray-50">
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Position</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Department</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Salary</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {employees.map(emp => (
                                                <tr key={emp.id}>
                                                    <td className="px-6 py-4">
                                                        <p className="font-semibold">{emp.name}</p>
                                                        <p className="text-sm text-gray-500">{emp.email}</p>
                                                    </td>
                                                    <td className="px-6 py-4">{emp.position}</td>
                                                    <td className="px-6 py-4">{emp.department}</td>
                                                    <td className="px-6 py-4">${emp.salary}</td>
                                                    <td className="px-6 py-4">
                                                        <div className="flex space-x-2">
                                                            <button onClick={() => openModal('employee', emp)} className="text-blue-600 hover:text-blue-800">
                                                                <Icons.Edit />
                                                            </button>
                                                            <button onClick={() => handleDeleteEmployee(emp.id)} className="text-red-600 hover:text-red-800">
                                                                <Icons.Trash />
                                                            </button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    {employees.length === 0 && <p className="text-center py-8 text-gray-500">No employees yet</p>}
                                </div>
                            </div>
                        )}

                        {activeTab === 'payroll' && (
                            <div>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold">Payroll</h2>
                                    <button
                                        onClick={() => openModal('payroll')}
                                        className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700"
                                    >
                                        <Icons.Plus />
                                        <span>Generate Payroll</span>
                                    </button>
                                </div>
                                <div className="bg-white rounded-lg shadow-md overflow-x-auto">
                                    <table className="w-full">
                                        <thead className="bg-gray-50">
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Employee</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Period</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Net Salary</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {payrolls.map(pay => (
                                                <tr key={pay.id}>
                                                    <td className="px-6 py-4 font-semibold">{pay.employee_name}</td>
                                                    <td className="px-6 py-4">{pay.month} {pay.year}</td>
                                                    <td className="px-6 py-4 font-bold text-green-600">${parseFloat(pay.net_salary).toFixed(2)}</td>
                                                    <td className="px-6 py-4">
                                                        <button onClick={() => downloadPayslip(pay)} className="text-blue-600 hover:text-blue-800 flex items-center space-x-1">
                                                            <Icons.Download />
                                                            <span>Download</span>
                                                        </button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    {payrolls.length === 0 && <p className="text-center py-8 text-gray-500">No payrolls yet</p>}
                                </div>
                            </div>
                        )}

                        {activeTab === 'leave' && (
                            <div>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold">Leave Management</h2>
                                    <button
                                        onClick={() => openModal('leave')}
                                        className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700"
                                    >
                                        <Icons.Plus />
                                        <span>New Leave</span>
                                    </button>
                                </div>
                                <div className="bg-white rounded-lg shadow-md overflow-x-auto">
                                    <table className="w-full">
                                        <thead className="bg-gray-50">
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Employee</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Duration</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Days</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {leaveRequests.map(leave => (
                                                <tr key={leave.id}>
                                                    <td className="px-6 py-4 font-semibold">{leave.employee_name}</td>
                                                    <td className="px-6 py-4 text-sm">{leave.start_date} to {leave.end_date}</td>
                                                    <td className="px-6 py-4">{leave.days}</td>
                                                    <td className="px-6 py-4">
                                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                                                            leave.status === 'Approved' ? 'bg-green-100 text-green-700' :
                                                            leave.status === 'Rejected' ? 'bg-red-100 text-red-700' :
                                                            'bg-yellow-100 text-yellow-700'
                                                        }`}>
                                                            {leave.status}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        {leave.status === 'Pending' && (
                                                            <div className="flex space-x-2">
                                                                <button onClick={() => handleLeaveAction(leave.id, 'approve')} className="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">
                                                                    Approve
                                                                </button>
                                                                <button onClick={() => handleLeaveAction(leave.id, 'reject')} className="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700">
                                                                    Reject
                                                                </button>
                                                            </div>
                                                        )}
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    {leaveRequests.length === 0 && <p className="text-center py-8 text-gray-500">No leave requests yet</p>}
                                </div>
                            </div>
                        )}

                        {activeTab === 'attendance' && (
                            <div>
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-2xl font-bold">Attendance</h2>
                                    <button
                                        onClick={() => openModal('attendance')}
                                        className="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700"
                                    >
                                        <Icons.Plus />
                                        <span>Mark Attendance</span>
                                    </button>
                                </div>
                                <div className="bg-white rounded-lg shadow-md overflow-x-auto">
                                    <table className="w-full">
                                        <thead className="bg-gray-50">
                                            <tr>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Employee</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Date</th>
                                                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {attendance.map(att => (
                                                <tr key={att.id}>
                                                    <td className="px-6 py-4 font-semibold">{att.employee_name}</td>
                                                    <td className="px-6 py-4">{att.date}</td>
                                                    <td className="px-6 py-4">
                                                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                                                            att.status === 'Present' ? 'bg-green-100 text-green-700' :
                                                            att.status === 'Absent' ? 'bg-red-100 text-red-700' :
                                                            'bg-yellow-100 text-yellow-700'
                                                        }`}>
                                                            {att.status}
                                                        </span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    {attendance.length === 0 && <p className="text-center py-8 text-gray-500">No attendance records yet</p>}
                                </div>
                            </div>
                        )}
                    </div>

                    {showModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg p-8 max-w-md w-full max-h-screen overflow-y-auto">
                                <h3 className="text-2xl font-bold mb-6">
                                    {editingItem ? 'Edit' : 'Add'} {modalType.charAt(0).toUpperCase() + modalType.slice(1)}
                                </h3>

                                {modalType === 'employee' && (
                                    <div className="space-y-4">
                                        <input type="text" placeholder="Full Name" value={employeeForm.name} onChange={(e) => setEmployeeForm({ ...employeeForm, name: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="email" placeholder="Email" value={employeeForm.email} onChange={(e) => setEmployeeForm({ ...employeeForm, email: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="text" placeholder="Position" value={employeeForm.position} onChange={(e) => setEmployeeForm({ ...employeeForm, position: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="text" placeholder="Department" value={employeeForm.department} onChange={(e) => setEmployeeForm({ ...employeeForm, department: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="number" placeholder="Salary" value={employeeForm.salary} onChange={(e) => setEmployeeForm({ ...employeeForm, salary: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="date" value={employeeForm.joinDate} onChange={(e) => setEmployeeForm({ ...employeeForm, joinDate: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="number" placeholder="Leave Balance" value={employeeForm.leaveBalance} onChange={(e) => setEmployeeForm({ ...employeeForm, leaveBalance: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <div className="flex space-x-3">
                                            <button onClick={handleAddEmployee} className="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Save</button>
                                            <button onClick={closeModal} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                                        </div>
                                    </div>
                                )}

                                {modalType === 'payroll' && (
                                    <div className="space-y-4">
                                        <select value={payrollForm.employeeId} onChange={(e) => setPayrollForm({ ...payrollForm, employeeId: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                                            <option value="">Select Employee</option>
                                            {employees.map(emp => <option key={emp.id} value={emp.id}>{emp.name}</option>)}
                                        </select>
                                        <select value={payrollForm.month} onChange={(e) => setPayrollForm({ ...payrollForm, month: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                                            <option value="">Select Month</option>
                                            {['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'].map(m => <option key={m} value={m}>{m}</option>)}
                                        </select>
                                        <input type="number" placeholder="Year" value={payrollForm.year} onChange={(e) => setPayrollForm({ ...payrollForm, year: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="number" placeholder="Basic Salary (optional)" value={payrollForm.basicSalary} onChange={(e) => setPayrollForm({ ...payrollForm, basicSalary: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="number" placeholder="Allowances" value={payrollForm.allowances} onChange={(e) => setPayrollForm({ ...payrollForm, allowances: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="number" placeholder="Deductions" value={payrollForm.deductions} onChange={(e) => setPayrollForm({ ...payrollForm, deductions: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="number" placeholder="Tax Rate %" value={payrollForm.taxRate} onChange={(e) => setPayrollForm({ ...payrollForm, taxRate: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <div className="flex space-x-3">
                                            <button onClick={handleAddPayroll} className="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Generate</button>
                                            <button onClick={closeModal} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                                        </div>
                                    </div>
                                )}

                                {modalType === 'leave' && (
                                    <div className="space-y-4">
                                        <select value={leaveForm.employeeId} onChange={(e) => setLeaveForm({ ...leaveForm, employeeId: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                                            <option value="">Select Employee</option>
                                            {employees.map(emp => <option key={emp.id} value={emp.id}>{emp.name}</option>)}
                                        </select>
                                        <select value={leaveForm.type} onChange={(e) => setLeaveForm({ ...leaveForm, type: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                                            <option value="Annual">Annual</option>
                                            <option value="Sick">Sick</option>
                                            <option value="Emergency">Emergency</option>
                                            <option value="Unpaid">Unpaid</option>
                                        </select>
                                        <input type="date" value={leaveForm.startDate} onChange={(e) => setLeaveForm({ ...leaveForm, startDate: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <input type="date" value={leaveForm.endDate} onChange={(e) => setLeaveForm({ ...leaveForm, endDate: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <textarea placeholder="Reason" value={leaveForm.reason} onChange={(e) => setLeaveForm({ ...leaveForm, reason: e.target.value })} className="w-full px-4 py-2 border rounded-lg" rows="3" />
                                        <div className="flex space-x-3">
                                            <button onClick={handleAddLeave} className="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Submit</button>
                                            <button onClick={closeModal} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                                        </div>
                                    </div>
                                )}

                                {modalType === 'attendance' && (
                                    <div className="space-y-4">
                                        <select value={attendanceForm.employeeId} onChange={(e) => setAttendanceForm({ ...attendanceForm, employeeId: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                                            <option value="">Select Employee</option>
                                            {employees.map(emp => <option key={emp.id} value={emp.id}>{emp.name}</option>)}
                                        </select>
                                        <input type="date" value={attendanceForm.date} onChange={(e) => setAttendanceForm({ ...attendanceForm, date: e.target.value })} className="w-full px-4 py-2 border rounded-lg" />
                                        <select value={attendanceForm.status} onChange={(e) => setAttendanceForm({ ...attendanceForm, status: e.target.value })} className="w-full px-4 py-2 border rounded-lg">
                                            <option value="Present">Present</option>
                                            <option value="Absent">Absent</option>
                                            <option value="Half Day">Half Day</option>
                                            <option value="Late">Late</option>
                                        </select>
                                        <div className="flex space-x-3">
                                            <button onClick={handleAddAttendance} className="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Mark</button>
                                            <button onClick={closeModal} className="flex-1 bg-gray-300 px-4 py-2 rounded-lg hover:bg-gray-400">Cancel</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>

</html>
